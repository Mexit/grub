From d193517fee2b49036849702e526c70ac0981655e Mon Sep 17 00:00:00 2001
From: Thomas Frauendorfer <tf@miray.de>
Date: Tue, 6 May 2014 14:44:39 +0200
Subject: [PATCH 18/41] add debug mode helper

---
 include/grub/miray_debug.h | 35 +++++++++++++++++++++++++++++++++++
 1 file changed, 35 insertions(+)
 create mode 100755 include/grub/miray_debug.h

diff --git a/include/grub/miray_debug.h b/include/grub/miray_debug.h
new file mode 100755
index 0000000..4d02b87
--- /dev/null
+++ b/include/grub/miray_debug.h
@@ -0,0 +1,35 @@
+/* miray_debug.h - check debug flag */
+/*
+ *  GRUB  --  GRand Unified Bootloader
+ *  Copyright (C) 2000,2001,2002,2003,2005,2006,2007,2008,2009  Free Software Foundation, Inc.
+ *  Copyright (C) 2014 Miray Software <oss@miray.de>
+ *
+ *  GRUB is free software: you can redistribute it and/or modify
+ *  it under the terms of the GNU General Public License as published by
+ *  the Free Software Foundation, either version 3 of the License, or
+ *  (at your option) any later version.
+ *
+ *  GRUB is distributed in the hope that it will be useful,
+ *  but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ *  GNU General Public License for more details.
+ *
+ *  You should have received a copy of the GNU General Public License
+ *  along with GRUB.  If not, see <http://www.gnu.org/licenses/>.
+ */
+
+#ifndef MIRAY_DEBUG_H
+#define MIRAY_DEBUG_H 1
+
+#include <grub/env.h>
+
+static inline int miray_debugmode(void)
+{
+  const char *debugmode = grub_env_get("debugmode");
+  if (debugmode == 0 || debugmode[0] == '\0')
+    return 0;
+  else
+    return 1;
+}
+
+#endif
-- 
1.9.2.msysgit.0

